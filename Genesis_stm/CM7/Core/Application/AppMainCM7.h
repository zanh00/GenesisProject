//////////////////////////////////////////////////////////////////////////////
/*
 * AppMainCM7.h
 *
 *  Created on: Jul 13, 2024
 *      Author: Žan Hertiš
 */
 ////////////////////////////////////////////////////////////////////////////

#ifndef APPMAIN_CM7_H
#define APPMAIN_CM7_H

//////////////////////////////////////////////////////////////////////////////
// Includes 
//////////////////////////////////////////////////////////////////////////////

#include <stdint.h>
#include <stdbool.h>

#include "main.h"
#include "i2c.h"
#include "tim.h"
#include "usart.h"
#include "gpio.h"
#include "FreeRTOS.h"
#include "task.h"
#include "queue.h"
#include "event_groups.h"
#include "semphr.h"

//////////////////////////////////////////////////////////////////////////////
// Defines 
//////////////////////////////////////////////////////////////////////////////

#define DMA_BUFFER __attribute__((section(".sram1")))

typedef union {
    uint32_t    U32;
    float       F;
} DataUnion_t;

typedef struct Message
{
    uint8_t     Id;
    DataUnion_t Data;
} Message_t;


//////////////////////////////////////////////////////////////////////////////
// Global Variables 
//////////////////////////////////////////////////////////////////////////////

extern QueueHandle_t q_UserCommand;
extern QueueHandle_t q_DiagnosticData;
extern QueueHandle_t q_Curvature;
extern QueueHandle_t q_LateralDeviation;
extern QueueHandle_t q_LongitudinalTaskData;
extern QueueHandle_t q_speed;

extern EventGroupHandle_t  e_commandFlags;
extern EventGroupHandle_t  e_statusFlags;

//////////////////////////////////////////////////////////////////////////////
// Function prototypes 
//////////////////////////////////////////////////////////////////////////////

void AppCM7_Main();


#endif /* APPMAIN_CM7_H */